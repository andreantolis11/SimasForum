<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <link th:rel="stylesheet" th:href="@{/webjars/bootstrap/5.1.3/dist/css/bootstrap.css}"/>
    <link rel="stylesheet" th:href="@{/css/thread.css}">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <title>Thread Detail</title>
</head>
<body>
<div style="text-decoration: none;" th:replace="fragments/nav :: navbar"></div>

<div class="container" style="background-color: #FF5045; margin-top: 50px; padding: 15px; border-radius: 20px">
    <div class="box-container">
        <div class="thread-container">
            <div class="thread-content-container">
                <div>
                    <div th:text="${userName} + ', ' + ${threadDetail.datePost}"></div>
                </div>
                <h3 th:text="${threadDetail.title}"></h3>
                <div class="content" th:text="${threadDetail.content}"></div>
            </div>
            <div class="thread-vote-container">
                <form method="post" th:action="@{'/thread/{id}/{isUpVote}' (isUpVote=true, id=${threadDetail.id})}">
                    <button class="btn-upvote">
                        <span  th:if="${upVotes == 1}" class="glyphicon glyphicon-menu-up up-vote" style="color: red;"></span>
                        <span  th:unless="${upVotes == 1}" class="glyphicon glyphicon-menu-up up-vote"></span>
                    </button>
                </form>
                <h4 th:text="${threadDetail.voteScore}">0</h4>
                <form method="post" th:action="@{'/thread/{threadId}/{isUpVote}' (isUpVote=false, threadId=${threadDetail.id})}">
                    <button class="btn-downvote">
                        <span  th:if="${upVotes == 0}" class="glyphicon glyphicon-menu-down" style="color: red;"></span>
                        <span  th:unless="${upVotes == 0}" class="glyphicon glyphicon-menu-down"></span>
                    </button>
                </form>
            </div>
            <!--                <button type="button" onclick="getViews();">Get Views Count</button>-->
        </div>
        <div class="box-container">
            <div class="thread-container">
                <div class="thread-content-container">
                    <div>
                        <h2>Replies</h2>
                        <form th:action="@{'/reply/thread/{id}' (id=${threadDetail.id})}" method="post">
                            <div class="form-group">
                                <input name="content" style="background-color: #FFFFFF; border-radius: 20px;" type="text" class="form-control" id="reply" placeholder="Add a reply...">
                            </div>
                        </form>
                        <div th:if="${replies} != null">
                            <div class="thread-content-container" th:each="reply : ${replies}">
                                   <h4 th:text="${reply.content}" style="margin-bottom:0px"></h4>
                                    <a style="margin-left:1%" th:onclick="|hide('r_form_'+${reply.id})|">balas</a>
                                    <form th:id="'r_form_'+${reply.id}" style="display: none;" th:action="@{'/reply/reply/{id}' (id=${reply.id})}" method="post">
                                        <div class="form-group" style="margin-left: 5%;">
                                            <input name="content" style="background-color: #FFFFFF; border-radius: 20px;" type="text" class="form-control" th:id="${reply.id}" placeholder="Add a reply...">
                                        </div>
                                    </form>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>
<script th:src="@{/webjars/bootstrap/5.1.3/dist/js/bootstrap.bundle.js}"></script>
<!--<script type="text/javascript" th:inline="javascript">-->
<!--    function getViews() {-->
<!--        alert("You've accessed " + history.length + " web pages in this session.");-->
<!--    }-->
<!--</script>-->
<script>
    function hide(id){
        var x = document.getElementById(id);
        if (x.style.display === "none") {
            x.style.display = "";
        } else {
            x.style.display = "none";
        }
    }
</script>
</body>
</html>